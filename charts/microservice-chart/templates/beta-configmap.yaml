{{- if or (and .Values.canaryDelivery.create .Values.canaryDelivery.deployment.envConfig) (and .Values.canaryDelivery.create .Values.canaryDelivery.deployment.configMapFromFile) -}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "microservice-chart.fullnameCanaryDelivery" . }}
  namespace: {{ .Values.namespace }}
  labels:
    {{- include "microservice-chart.labelsCanaryDelivery" . | nindent 4 }}
data:
  {{- if .Values.canaryDelivery.create }}
  CANARY: "true"
  {{- end }}
  {{- if .Values.canaryDelivery.deployment.envConfig -}}
  {{- toYaml .Values.canaryDelivery.deployment.envConfig | nindent 2 }}
  {{- end }}
  {{- if .Values.canaryDelivery.deployment.configMapFromFile -}}
  {{- toYaml .Values.canaryDelivery.deployment.configMapFromFile | nindent 2 }}
  {{- end }}
{{- end }}

---


